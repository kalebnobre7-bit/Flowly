<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0A84FF">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Flowly">
    <title>Flowly</title>
    <link rel="icon" type="image/svg+xml" href="icon.svg">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon.svg">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="styles.css?v=2">
</head>

<body class="antialiased">
    <div class="max-w-[1400px] mx-auto">
        <!-- Header -->
        <div class="nav-container">
            <div class="logo-area">
                <img src="logo_flowly.png" alt="Flowly" class="logo-img">
            </div>

            <div class="segmented-control">
                <button id="btnMonth" class="segment-btn" onclick="setView('month')">Mês</button>
                <button id="btnWeek" class="segment-btn active" onclick="setView('week')">Semana</button>
                <button id="btnToday" class="segment-btn" onclick="setView('today')">Hoje</button>
                <button id="btnRoutine" class="segment-btn" onclick="setView('routine')">Rotina</button>
                <button id="btnAnalytics" class="segment-btn" onclick="setView('analytics')">Analytics</button>
                <button id="btnSettings" class="segment-btn" onclick="setView('settings')"><i data-lucide="settings"
                        style="width: 16px; height: 16px;"></i></button>
            </div>

            <div class="flex items-center gap-3">
                <button id="btnTogglePeriods" class="utility-btn" title="Mostrar/Ocultar períodos"><i data-lucide="list"
                        style="width: 18px; height: 18px;"></i></button>
                <div class="relative">
                    <button id="btnUser" class="utility-btn"><i data-lucide="user"
                            style="width: 18px; height: 18px;"></i></button>
                    <div id="userDropdown" class="context-menu"
                        style="top: 100%; right: 0; margin-top: 8px; min-width: 180px; display: none; flex-direction: column;">
                        <div id="userEmail" class="p-3 text-xs text-gray-500 border-b border-[#333]">user@email.com
                        </div>
                        <div class="p-2 hover:bg-[#333] cursor-pointer rounded text-sm text-red-400" id="btnLogout">Sair
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Week Navigation -->
        <div id="weekNav" class="hidden flex items-center justify-center gap-4 mb-6">
            <button id="btnPrevWeek" class="utility-btn" onclick="changeWeek(-1)"><i data-lucide="chevron-left"
                    style="width: 18px; height: 18px;"></i></button>
            <div class="text-sm text-gray-400" id="weekLabel">Semana Atual</div>
            <button id="btnNextWeek" class="utility-btn" onclick="changeWeek(1)"><i data-lucide="chevron-right"
                    style="width: 18px; height: 18px;"></i></button>
            <button id="btnCurrentWeek" class="btn-secondary text-xs px-3 py-1 ml-4" onclick="goToCurrentWeek()"
                style="width: auto; padding: 6px 12px;">Semana Atual</button>
        </div>

        <!-- Main Content -->
        <div id="contentArea">
            <div id="monthView" class="hidden"></div>
            <div id="weekGrid" class="grid grid-cols-7 gap-0">
                <!-- Javascript will populate this -->
            </div>
            <div id="routineView" class="hidden"></div>
            <div id="analyticsView" class="hidden"></div>
            <div id="settingsView" class="hidden"></div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <div id="floatingAddBtn" class="floating-add-btn">
        <img src="icon.svg" alt="Flowly" style="width: 34px; height: 34px;">
    </div>

    <!-- Quick Add Menu -->
    <div id="quickAddMenu" class="context-menu"
        style="position: fixed; bottom: 100px; right: 32px; min-width: 200px; flex-direction: column; gap: 4px;">
        <div class="quick-add-option p-2 hover:bg-[#333] rounded cursor-pointer text-sm flex items-center gap-2"
            data-type="routine"><i data-lucide="repeat" style="width: 16px; height: 16px;"></i> Adicionar rotina diária
        </div>
        <div class="quick-add-option p-2 hover:bg-[#333] rounded cursor-pointer text-sm flex items-center gap-2"
            data-type="weekly"><i data-lucide="calendar" style="width: 16px; height: 16px;"></i> Tarefa semanal
            recorrente</div>
        <div class="quick-add-option p-2 hover:bg-[#333] rounded cursor-pointer text-sm flex items-center gap-2"
            data-type="custom"><i data-lucide="plus" style="width: 16px; height: 16px;"></i> Nova tarefa customizada
        </div>
    </div>

    <!-- Modal: Tarefa Semanal Recorrente -->
    <div id="weeklyModal" class="modal-overlay" style="z-index: 9999;">
        <div class="modal-content" style="max-width: 420px;">
            <h2 class="text-xl font-bold mb-1 flex items-center gap-2">
                <i data-lucide="calendar-repeat" style="width: 22px; height: 22px; color: #0A84FF;"></i>
                Tarefa Semanal
            </h2>
            <p class="text-gray-500 text-sm mb-5">Aparece automaticamente nos dias selecionados toda semana</p>

            <input type="text" id="weeklyTaskText" class="task-input mb-5"
                placeholder="Ex: Reunião de equipe, Academia, Inglês..." style="background: rgba(255,255,255,0.05);"
                autocomplete="off">

            <p class="text-xs text-gray-400 mb-3 uppercase tracking-wider font-semibold">Dias da semana</p>
            <div class="flex gap-2 mb-6" style="justify-content: space-between;">
                <button class="weekly-day-btn" data-day="0">Dom</button>
                <button class="weekly-day-btn" data-day="1">Seg</button>
                <button class="weekly-day-btn" data-day="2">Ter</button>
                <button class="weekly-day-btn" data-day="3">Qua</button>
                <button class="weekly-day-btn" data-day="4">Qui</button>
                <button class="weekly-day-btn" data-day="5">Sex</button>
                <button class="weekly-day-btn" data-day="6">Sáb</button>
            </div>

            <button id="btnSaveWeekly" class="btn-primary mb-3">Salvar</button>
            <button id="btnCancelWeekly" class="btn-secondary">Cancelar</button>
        </div>
    </div>

    <!-- Edit Context Menu -->
    <div id="editToolbar" class="context-menu">
        <button class="toolbar-btn" data-action="bold"><i data-lucide="bold"
                style="width: 16px; height: 16px;"></i></button>
        <button class="toolbar-btn" data-action="italic"><i data-lucide="italic"
                style="width: 16px; height: 16px;"></i></button>
        <button class="toolbar-btn" data-action="strikethrough"><i data-lucide="strikethrough"
                style="width: 16px; height: 16px;"></i></button>
        <div style="width: 1px; background: #333; margin: 0 4px;"></div>
        <button class="toolbar-btn" data-action="color"><i data-lucide="palette"
                style="width: 16px; height: 16px;"></i></button>
        <button class="toolbar-btn" data-action="habit"><i data-lucide="repeat"
                style="width: 16px; height: 16px;"></i></button>
        <div style="width: 1px; background: #333; margin: 0 4px;"></div>
        <button class="toolbar-btn" data-action="delete" style="color: var(--accent-red)"><i data-lucide="trash-2"
                style="width: 16px; height: 16px;"></i></button>
    </div>

    <!-- Color Picker -->
    <div id="colorMenu" class="context-menu" style="gap: 6px;">
        <div class="color-swatch w-6 h-6 rounded-full cursor-pointer border-2 border-transparent hover:scale-110 transition-transform"
            style="background: #6b7280;" data-color="default"></div>
        <div class="color-swatch w-6 h-6 rounded-full cursor-pointer border-2 border-transparent hover:scale-110 transition-transform"
            style="background: #30d158;" data-color="green"></div>
        <div class="color-swatch w-6 h-6 rounded-full cursor-pointer border-2 border-transparent hover:scale-110 transition-transform"
            style="background: #ffd60a;" data-color="yellow"></div>
        <div class="color-swatch w-6 h-6 rounded-full cursor-pointer border-2 border-transparent hover:scale-110 transition-transform"
            style="background: #ff9f0a;" data-color="orange"></div>
        <div class="color-swatch w-6 h-6 rounded-full cursor-pointer border-2 border-transparent hover:scale-110 transition-transform"
            style="background: #ff453a;" data-color="red"></div>
    </div>

    <!-- Auth Modal -->
    <div id="authModal" class="modal-overlay show">
        <div class="modal-content">
            <div class="text-center mb-6">
                <img src="logo_flowly.png" alt="Flowly" class="h-16 mx-auto mb-4">
                <h2 class="text-2xl font-bold">Bem-vindo</h2>
            </div>

            <div id="authLogin">
                <input type="email" id="loginEmail" class="task-input mb-3" style="background: rgba(0,0,0,0.3);"
                    placeholder="Email" autocomplete="username">
                <input type="password" id="loginPassword" class="task-input mb-4" style="background: rgba(0,0,0,0.3);"
                    placeholder="Senha" autocomplete="current-password">

                <div class="flex items-center gap-2 mb-6">
                    <input type="checkbox" id="keepLoggedIn" class="checkbox-custom" checked>
                    <label for="keepLoggedIn" class="text-sm text-gray-400">Manter conectado</label>
                </div>

                <button id="btnLogin" class="btn-primary">Entrar</button>
                <button id="btnShowSignup" class="btn-secondary">Criar conta</button>
                <div id="authMessage" class="text-center text-xs mt-4 h-4 text-red-400"></div>
            </div>

            <div id="authSignup" style="display:none;">
                <input type="email" id="signupEmail" class="task-input mb-3" style="background: rgba(0,0,0,0.3);"
                    placeholder="Email">
                <input type="password" id="signupPassword" class="task-input mb-6" style="background: rgba(0,0,0,0.3);"
                    placeholder="Senha (mín. 6 caracteres)">
                <button id="btnSignup" class="btn-primary">Cadastrar</button>
                <button id="btnShowLogin" class="btn-secondary">Voltar</button>
            </div>
        </div>
    </div>

    <script src="js/app.js?v=2"></script>
</body>

</html>